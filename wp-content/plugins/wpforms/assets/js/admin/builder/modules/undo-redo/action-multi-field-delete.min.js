export default function(e,d,n){class l extends WPForms.Admin.Builder.UndoRedoActionCommandBase.get(){static id="ActionMultiFieldDeleteCommand";constructor(e){super(e),this.actionName=this.getActionName()}execute(){r.UndoRedo.executeTriggerEvents&&this.deleteFields(this.args)}undo(){r.UndoRedo.executeTriggerEvents&&this.addFields(this.args)}deleteFields(i){r.UndoRedo.preventRecord(!0),this.replaceDOMElementContent(r.el.$allFieldsPreview,i.new.$allFieldsPreview),this.replaceDOMElementContent(r.el.$allFieldsOptions,i.new.$allFieldsOptions),i.fieldIds.forEach(e=>{var d=n("#wpforms-field-"+e).parents(".wpforms-field-layout-columns"),l=i.multiFieldSettings[e]?.type;r.el.$builder.trigger("wpformsFieldDelete",[e,l,d]),r.UndoRedoHelpersFields.applyAddFieldsButtonAttributes(l,i.new.$addFieldsTab)}),r.el.$builder.trigger("wpformsMultiFieldDelete",[i.fieldIds]),r.UndoRedoHelpersFields.reInitFields(),r.UndoRedo.preventRecord(!1)}addFields(t){r.UndoRedo.preventRecord(!0),this.replaceDOMElementContent(r.el.$allFieldsPreview,t.old.$allFieldsPreview),this.replaceDOMElementContent(r.el.$allFieldsOptions,t.old.$allFieldsOptions);let o={isUndoRedo:!0};t.fieldIds.forEach(e=>{var d=n("#wpforms-field-"+e),l=n("#wpforms-field-option-"+e),i=t.multiFieldSettings[e]?.type;r.el.$builder.trigger("wpformsFieldAdd",[e,t.multiFieldSettings[e]?.type,o,d,l]),r.UndoRedoHelpersFields.applyAddFieldsButtonAttributes(i,t.old.$addFieldsTab)}),r.UndoRedoHelpersFields.reInitFields(),r.UndoRedo.preventRecord(!1)}getActionName(){var e;return this.actionName||(e="#"+this.args.fieldIds.join(", #"),[wp.i18n.__("Delete Fields","wpforms"),r.actionNameSeparator,e].filter(Boolean).join(" "))}}let r={el:{},trackFieldSettings:{},init(){r.setup(),r.el.$builder.on("wpformsBuilderReady",_.debounce(r.ready,250))},setup(){r.el.$document=n(e),r.el.$builder=n("#wpforms-builder"),r.el.$allFieldsPreview=r.el.$builder.find(".wpforms-field-wrap"),r.el.$allFieldsOptions=r.el.$builder.find(".wpforms-field-options")},ready(){try{r.UndoRedo=WPForms.Admin.Builder.UndoRedo,r.UndoRedoHelpers=WPForms.Admin.Builder.UndoRedoHelpers,r.UndoRedoHelpersFields=WPForms.Admin.Builder.UndoRedoHelpersFields,r.actionNameSeparator=r.UndoRedo.config.actionNameSeparator,r.el={...r.el,...r.UndoRedo.el}}catch(e){return void wpf.debug("UndoRedoActionMultiFieldDelete: Dependency modules are not available.")}r.UndoRedo.registerCommand(l),r.events()},events(){r.el.$builder.on("wpformsBeforeMultiFieldDelete",r.onBeforeMultiFieldDelete).on("wpformsMultiFieldDelete",r.onMultiFieldDelete)},onBeforeMultiFieldDelete(e,d){r.UndoRedo.isRecordPrevented()||(r.trackMultiFieldSettings=[],d.forEach(e=>{r.trackMultiFieldSettings[e]=wpf.getField(e)}),r.UndoRedoHelpersFields.getCurrentFieldsElements(),r.UndoRedoHelpersFields.getCurrentAddFieldsTab())},onMultiFieldDelete(e,d){r.UndoRedo.isRecordPrevented()||_.debounce(r.recordCommand,0)(e,d)},recordCommand(e,d){d=r.UndoRedo.getCommand("ActionMultiFieldDeleteCommand",{fieldIds:d,multiFieldSettings:r.trackMultiFieldSettings,event:e.type??"",old:{...r.UndoRedoHelpersFields.getTrackedFieldsElements(),$addFieldsTab:r.UndoRedoHelpersFields.getTrackedAddFieldsTab()},new:{...r.UndoRedoHelpersFields.getCurrentFieldsElements(),$addFieldsTab:r.UndoRedoHelpersFields.getCurrentAddFieldsTab()}});r.UndoRedo.record(d)}};return r}