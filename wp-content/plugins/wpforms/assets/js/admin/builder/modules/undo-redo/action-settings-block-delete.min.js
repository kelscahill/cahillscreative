export default function(e,t,o){class n extends WPForms.Admin.Builder.UndoRedoActionCommandBase.get(){static id="ActionSettingsBlockDeleteCommand";constructor(e){super(e),this.actionName=this.getActionName()}execute(){d.UndoRedo.executeTriggerEvents&&this.deleteBlock(this.args)}undo(){d.UndoRedo.executeTriggerEvents&&this.addBlock(this.args)}deleteBlock(e){var t;e.new.$container?.length&&e.$block?.length&&(d.preventRecordingCommand=!0,t=d.UndoRedoActionSettingsBlockAdd.getSettingsSection(e.$settingsSection),this.replaceDOMElementContent(t,e.new.$container),d.UndoRedoActionSettingsBlockAdd.reInitBlocks(t),d.el.$builder.trigger("wpformsSettingsBlockDeleted",[e.blockType,e.blockId]),d.preventRecordingCommand=!1)}addBlock(e){var t;e.new.$container?.length&&e.$block?.length&&(d.preventRecordingCommand=!0,t=d.UndoRedoActionSettingsBlockAdd.getSettingsSection(e.$settingsSection),this.replaceDOMElementContent(t,e.old.$container),d.UndoRedoActionSettingsBlockAdd.reInitBlocks(t),d.el.$builder.trigger("wpformsSettingsBlockCloned",[e.$block,e.blockId]),d.preventRecordingCommand=!1)}getActionName(){return this.actionName||[wp.i18n.__("Delete settings block","wpforms"),d.actionNameSeparator,this.args.settingsSectionTitle].filter(Boolean).join(" ")}}let d={el:{},trackFieldSettings:{},init(){d.setup(),d.el.$builder.on("wpformsBuilderReady",_.debounce(d.ready,250))},setup(){d.el.$document=o(e),d.el.$builder=o("#wpforms-builder")},ready(){try{d.UndoRedo=WPForms.Admin.Builder.UndoRedo,d.UndoRedoHelpers=WPForms.Admin.Builder.UndoRedoHelpers,d.UndoRedoHelpersFields=WPForms.Admin.Builder.UndoRedoHelpersFields,d.UndoRedoActionSettingsBlockAdd=WPForms.Admin.Builder.UndoRedoActionSettingsBlockAdd,d.undoManager=d.UndoRedo.undoManager,d.actionNameSeparator=d.UndoRedo.config.actionNameSeparator,d.el={...d.el,...d.UndoRedo.el}}catch(e){return void wpf.debug("UndoRedoActionSettingsBlockDelete: Dependency modules are not available.")}d.UndoRedo.registerCommand(n),d.events()},events(){d.el.$builder.on("wpformsBeforeSettingsBlockDelete",d.onBeforeSettingsBlockDelete).on("wpformsSettingsBlockDeleted",d.onSettingsBlockDeleted).on("connectionDeleted",".wpforms-builder-provider",d.onConnectionDeleted)},onBeforeSettingsBlockDelete(e,t,n){d.UndoRedo.isRecordPrevented()||(d.$trackSettingsBlock=o(`.wpforms-builder-settings-block[data-block-type="${t}"][data-block-id="${n}"]`).clone(),d.$trackSettingsSection=d.UndoRedoActionSettingsBlockAdd.getSettingsSection(d.$trackSettingsBlock),d.trackSettingsSectionTitle=d.UndoRedoHelpers.getSectionTitle(d.$trackSettingsSection),d.UndoRedoHelpers.getCurrentContainer(d.$trackSettingsSection))},onSettingsBlockDeleted(e,t,n){!d.isRecordPrevented()&&d.$trackSettingsSection?.length&&(n=d.UndoRedo.getCommand("ActionSettingsBlockDeleteCommand",{$block:d.$trackSettingsBlock,blockId:n,blockType:t,event:e.type??"",settingsSectionTitle:d.trackSettingsSectionTitle,$settingsSection:d.$trackSettingsSection,old:{$container:d.UndoRedoHelpers.getTrackedContainer(d.$trackSettingsSection)},new:{$container:d.UndoRedoHelpers.getCurrentContainer(d.$trackSettingsSection)}}),d.UndoRedo.record(n))},onConnectionDeleted(e,o){if(o?.length){let t=o.data("connection_id"),n=o.html();o=function(e){return!(e.args?.connectionId&&e.args.connectionId===t||(e.inputId||e.inputName)&&(e.inputId&&n.includes(e.inputId)||e.inputName&&e.inputName.includes(`[${t}]`)))};d.undoManager.undoStack=d.undoManager.undoStack.filter(o),d.undoManager.redoStack=d.undoManager.redoStack.filter(o),d.UndoRedo.updateUI()}},isRecordPrevented(){return d.UndoRedo.isRecordPrevented()||d.preventRecordingCommand}};return d}