export default function(e,l,o){class d extends WPForms.Admin.Builder.UndoRedoActionCommandBase.get(){static id="ActionMultiFieldDuplicateCommand";constructor(e){super(e),this.actionName=this.getActionName()}execute(){n.UndoRedo.executeTriggerEvents&&this.duplicateFields(this.args)}undo(){n.UndoRedo.executeTriggerEvents&&this.deleteFields(this.args)}duplicateFields(t){n.UndoRedo.preventRecord(!0),this.replaceDOMElementContent(n.el.$allFieldsPreview,t.new.$allFieldsPreview),this.replaceDOMElementContent(n.el.$allFieldsOptions,t.new.$allFieldsOptions),t.fieldIds.forEach((e,l)=>{var l=t.newFieldIds[l],d=o("#wpforms-field-"+e),i=o("#wpforms-field-"+l);n.el.$builder.trigger("wpformsFieldDuplicated",[e,d,l,i])}),n.UndoRedoHelpersFields.reInitFields(t.newFieldIds[t.newFieldIds?.length-1]),n.UndoRedo.preventRecord(!1)}deleteFields(d){n.UndoRedo.preventRecord(!0),this.replaceDOMElementContent(n.el.$allFieldsPreview,d.old.$allFieldsPreview),this.replaceDOMElementContent(n.el.$allFieldsOptions,d.old.$allFieldsOptions),d.newFieldIds.forEach(e=>{var l=o("#wpforms-field-"+e).parents(".wpforms-field-layout-columns");n.el.$builder.trigger("wpformsFieldDelete",[e,d.multiFieldSettings[e]?.type,l])}),n.el.$builder.trigger("wpformsMultiFieldDelete",[d.fieldIds]),n.UndoRedoHelpersFields.reInitFields(),n.UndoRedo.preventRecord(!1)}getActionName(){var e;return this.actionName||(e="#"+this.args.fieldIds.join(", #"),[wp.i18n.__("Duplicate Fields","wpforms"),n.actionNameSeparator,e].filter(Boolean).join(" "))}}let n={el:{},trackMultiFieldSettings:{},init(){n.setup(),n.el.$builder.on("wpformsBuilderReady",_.debounce(n.ready,250))},setup(){n.el.$document=o(e),n.el.$builder=o("#wpforms-builder"),n.el.$allFieldsPreview=n.el.$builder.find(".wpforms-field-wrap"),n.el.$allFieldsOptions=n.el.$builder.find(".wpforms-field-options")},ready(){try{n.UndoRedo=WPForms.Admin.Builder.UndoRedo,n.UndoRedoHelpers=WPForms.Admin.Builder.UndoRedoHelpers,n.UndoRedoHelpersFields=WPForms.Admin.Builder.UndoRedoHelpersFields,n.actionNameSeparator=n.UndoRedo.config.actionNameSeparator,n.el={...n.el,...n.UndoRedo.el}}catch(e){return void wpf.debug("UndoRedoActionMultiFieldDuplicate: Dependency modules are not available.")}n.UndoRedo.registerCommand(d),n.events()},events(){n.el.$builder.on("wpformsBeforeMultiFieldDuplicate",n.onBeforeMultiFieldDuplicate).on("wpformsMultiFieldDuplicate",n.onMultiFieldDuplicate)},onBeforeMultiFieldDuplicate(e,l){n.UndoRedo.isRecordPrevented()||(n.trackMultiFieldSettings=[],l.forEach(e=>{n.trackMultiFieldSettings[e]=wpf.getField(e)}),n.UndoRedoHelpersFields.getCurrentFieldsElements())},onMultiFieldDuplicate(e,l,d){n.UndoRedo.isRecordPrevented()||(l=n.UndoRedo.getCommand("ActionMultiFieldDuplicateCommand",{fieldIds:l,newFieldIds:d,multiFieldSettings:n.trackMultiFieldSettings,event:e.type??"",old:n.UndoRedoHelpersFields.getTrackedFieldsElements(),new:n.UndoRedoHelpersFields.getCurrentFieldsElements()}),n.UndoRedo.record(l))}};return n}