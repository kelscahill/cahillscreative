export default function(e,o,n){class t extends WPForms.Admin.Builder.UndoRedoActionCommandBase.get(){static id="ActionImageAddRemoveCommand";constructor(e){super(e),this.actionName=this.getActionName()}execute(){a.UndoRedo.executeTriggerEvents&&this.updateContainer(this.args,"new")}undo(){a.UndoRedo.executeTriggerEvents&&this.updateContainer(this.args,"old")}updateContainer(o,n){if(o[n="new"===n?"new":"old"].$container?.length){a.UndoRedo.preventRecord(!0);var t=a.getContainer(o[n].$container);this.replaceDOMElementContent(t,o[n].$container);let e;e="wpformsImageUploadChange"===o.event?[o.$container,o.attachment]:[o.$button,o.$container],a.el.$builder.trigger(o.event,e),a.UndoRedo.preventRecord(!1)}}getActionName(){var e,o,n;return this.actionName||(e={add:wp.i18n.__("Select image","wpforms"),remove:wp.i18n.__("Remove image","wpforms")},n=a.UndoRedoHelpers.getElement(this.args.new.$container),o=a.UndoRedoHelpers.getSectionTitle(n),n=a.UndoRedoHelpers.getInputLabel(n),[e[this.args.action],a.actionNameSeparator,o,a.actionNameSeparator,n].filter(Boolean).join(" "))}}let a={el:{},sel:{buttons:[".wpforms-image-upload .wpforms-image-upload-remove",".wpforms-image-upload-control .wpforms-image-remove-button",".wpforms-image-upload .wpforms-image-upload-add",".wpforms-image-upload-control .wpforms-image-upload-button"].join(", "),container:".wpforms-image-upload, .wpforms-image-upload-control"},undoManager:null,init(){a.setup(),a.el.$builder.on("wpformsBuilderReady",_.debounce(a.ready,250))},setup(){a.el.$document=n(e),a.el.$builder=n("#wpforms-builder")},ready(){try{a.UndoRedo=WPForms.Admin.Builder.UndoRedo,a.UndoRedoHelpers=WPForms.Admin.Builder.UndoRedoHelpers,a.actionNameSeparator=a.UndoRedo.config.actionNameSeparator,a.el={...a.el,...a.UndoRedo.el}}catch(e){return void wpf.debug("UndoRedoActionImageAddRemove: Dependency modules are not available.")}a.UndoRedo.registerCommand(t),a.events()},events(){a.el.$builder.on("mousedown",a.sel.buttons,a.onMousedown).on("wpformsImageUploadAdd wpformsImageUploadRemove",a.onImageUpload).on("wpformsImageUploadChange",a.onImageUploadChange)},onMousedown(e){a.UndoRedo.isRecordPrevented()||(a.$trackButton=n(e.currentTarget),a.$trackContainer=a.getContainer(a.$trackButton),a.UndoRedoHelpers.getCurrentContainer(a.$trackContainer))},onImageUpload(e,o,n,t=null){a.UndoRedo.isRecordPrevented()||(n=a.UndoRedo.getCommand("ActionImageAddRemoveCommand",{action:a.$trackButton.hasClass("wpforms-image-upload-add")?"add":"remove",$button:a.$trackButton.clone(!0),$container:n,attachment:t,fieldId:a.$trackContainer.closest(".wpforms-field-option").data("field-id"),event:e.type??"",old:{$container:a.UndoRedoHelpers.getTrackedContainer(a.$trackContainer)},new:{$container:a.UndoRedoHelpers.getCurrentContainer(a.$trackContainer)}}),a.UndoRedo.record(n))},onImageUploadChange(e,o,n){a.onImageUpload(e,a.$trackButton,o,n)},getContainer(e){return(e=a.UndoRedoHelpers.getElement(e)).closest(a.sel.container)}};return a}