export default function(e,d,o){class l extends WPForms.Admin.Builder.UndoRedoActionCommandBase.get(){static id="ActionFieldMoveCommand";constructor(e){super(e),this.actionName=this.getActionName()}execute(){t.UndoRedo.executeTriggerEvents&&this.moveField(this.args,"new")}undo(){t.UndoRedo.executeTriggerEvents&&this.moveField(this.args,"old")}moveField(e,d){t.UndoRedo.preventRecord(!0),this.replaceDOMElementContent(t.el.$allFieldsPreview,e[d].$allFieldsPreview),this.replaceDOMElementContent(t.el.$allFieldsOptions,e[d].$allFieldsOptions),t.el.$builder.trigger("wpformsFieldMove",[e.ui,e.fieldId,e.multiSelectFields]),t.UndoRedoHelpersFields.reInitFields(e.fieldId),t.UndoRedo.preventRecord(!1)}getActionName(){var e,d;return this.actionName||(e=t.UndoRedoHelpersFields.getFieldName(this.args.type),d=`(#${this.args.fieldId})`,[wp.i18n.__("Move Field","wpforms"),t.actionNameSeparator,e,d].filter(Boolean).join(" "))}}let t={el:{},trackedFieldId:null,trackedFieldType:null,init(){t.setup(),t.el.$builder.on("wpformsBuilderReady",_.debounce(t.ready,250))},setup(){t.el.$document=o(e),t.el.$builder=o("#wpforms-builder"),t.el.$allFieldsPreview=t.el.$builder.find(".wpforms-field-wrap"),t.el.$allFieldsOptions=t.el.$builder.find(".wpforms-field-options")},ready(){try{t.UndoRedo=WPForms.Admin.Builder.UndoRedo,t.UndoRedoHelpers=WPForms.Admin.Builder.UndoRedoHelpers,t.UndoRedoHelpersFields=WPForms.Admin.Builder.UndoRedoHelpersFields,t.undoManager=t.UndoRedo.undoManager,t.actionNameSeparator=t.UndoRedo.config.actionNameSeparator,t.el={...t.el,...t.UndoRedo.el}}catch(e){return void wpf.debug("UndoRedoActionFieldMove: Dependency modules are not available.")}t.UndoRedo.registerCommand(l),t.events()},events(){t.el.$builder.on("wpformsBeforeFieldDragStart",t.onFieldDragStart).on("wpformsFieldMove",t.onFieldMove).on("wpformsMultiFieldMove",t.onMultiFieldMove)},onFieldDragStart(e,d){var l;t.UndoRedo.isRecordPrevented()||void 0!==d&&(l=o("#wpforms-field-"+d),t.trackedFieldId=d,t.trackedFieldType=l.data("field-type"),t.UndoRedoHelpersFields.getCurrentFieldsElements())},onFieldMove(e,d,l,o){o?.length||t.recordCommand(e,d,null)},onMultiFieldMove(e,d,l,o){o?.length&&t.recordCommand(e,d,o)},recordCommand(e,d,l){var o,i,n,r;t.UndoRedo.isRecordPrevented()||t.trackedFieldId&&(r=t.trackedFieldId,o=t.trackedFieldType,i=t.UndoRedoHelpersFields.getTrackedFieldsElements(),n=t.UndoRedoHelpersFields.getCurrentFieldsElements(),t.isPositionUnchanged(i,n)||(r=t.UndoRedo.getCommand("ActionFieldMoveCommand",{fieldId:r,type:o,ui:d??null,multiSelectFields:l??null,event:e.type??"",old:i,new:n}),t.UndoRedo.record(r)),t.resetTracking())},isPositionUnchanged(e,d){return!e?.$allFieldsPreview||!d?.$allFieldsPreview||e.$allFieldsPreview.html()===d.$allFieldsPreview.html()},resetTracking(){t.trackedFieldId=null,t.trackedFieldType=null}};return t}