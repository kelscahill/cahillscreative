var WPForms=window.WPForms||{};WPForms.Admin=WPForms.Admin||{},WPForms.Admin.Builder=WPForms.Admin.Builder||{},WPForms.Admin.Builder.FieldMap=WPForms.Admin.Builder.FieldMap||((e,a)=>{let o={},l={init(){a(l.ready)},ready(){l.setup(),l.events()},setup(){o.$builder=a("#wpforms-builder")},events(){o.$builder.on("input",".wpforms-field-map-table .key-source",function(){var e=a(this).val(),l=a(this).parent().parent().find(".key-destination"),i=l.data("name");e&&l.attr("name",i.replace("{source}",e.replace(/[^0-9a-zA-Z_-]/gi,"")))}),o.$builder.on("click",".wpforms-field-map-table .remove",function(e){e.preventDefault(),l.fieldMapTableDeleteRow(e,a(this))}),o.$builder.on("click",".wpforms-field-map-table .add",function(e){e.preventDefault(),l.fieldMapTableAddRow(e,a(this))}),a(e).on("wpformsFieldUpdate",l.fieldMapSelect)},fieldMapTableDeleteRow(e,l){var l=a(l),i=l.closest("tr"),l=l.closest("table"),t=i.closest(".wpforms-builder-settings-block");"1"<l.find("tr").length&&(i.remove(),o.$builder.trigger("wpformsFieldMapTableDeletedRow",[t]))},fieldMapTableAddRow(e,l){var l=a(l).closest("tr"),i=l.closest(".wpforms-builder-settings-block"),l=l.clone().insertAfter(l);l.find("input").val(""),l.find("select :selected").prop("selected",!1),l.find(".key-destination").attr("name",""),o.$builder.trigger("wpformsFieldMapTableAddedRow",[i,l])},fieldMapSelect(e,r){WPFormsUtils.triggerEvent(o.$builder,"wpformsBeforeFieldMapSelectUpdate").isDefaultPrevented()||a(".wpforms-field-map-select").each(function(){var l=a(this);let i=l.data("field-map-allowed"),e=l.data("field-map-placeholder");if(void 0!==e&&e||(e=wpforms_builder.select_field),void 0!==i&&i){i=i.split(" ");var t=l.find("option:selected").val();if(l.empty().append(a("<option>",{value:"",text:e})),r&&!a.isEmptyObject(r))for(var d in r){let e="";r[d]&&(e=void 0!==r[d].label&&""!==r[d].label.toString().trim()?wpf.sanitizeHTML(r[d].label.toString().trim()):wpforms_builder.field+" #"+d,0<=a.inArray(r[d].type,i)||0<=a.inArray("all-fields",i))&&l.append(a("<option>",{value:r[d].id,text:e}))}t&&l.find('option[value="'+t+'"]').prop("selected",!0);t=l.data("custom-value-support");"boolean"==typeof t&&t&&l.append(a("<option>",{value:"custom_value",text:wpforms_builder.add_custom_value_label,class:"wpforms-field-map-option-custom-value"})),o.$builder.trigger("wpformsFieldSelectMapped",[l])}})}};return l})(document,(window,jQuery)),WPForms.Admin.Builder.FieldMap.init();